{% extends "layout.html" %}

{% block title %}
    Room Library
{% endblock %}

{% block content %}
<!-- Show all rooms by user, and give user a way to view the room's data, code, and join room as host -->
<!-- Probably also create room for socket io with the buttons -->
<form action="/room-library" method="post">
<div id="roomSelect" class="form-group">
    {% if user_rooms != [] %}
    <div id='show_selection'>
        <select id="room" name='room_id'>   
        {% for room in user_rooms %}
            <option value='{{room.id}}'>

                {{ room.room_name }} {{room.room_code}}
            
            </option>

        {% endfor %}
        
        </select>
        <div id="functions">
            <button id='enter' type='submit' class="btn btn-primary">Enter</button>
            <button id='delete' type='button' class="btn btn-danger">Delete</button>
        </div>
    </div>
    {% endif %}

   

    <div>
        <a href="/create-room" class="btn btn-primary">Create a new room</a>
    </div>
</div>
</form>


<script>
    $(document).ready( ()=> {
        $('#delete').on('click', function() {
            let js_data = {'room_id' : $('#room').val()}
            $.ajax({
                url : "/_delete_room",
                type : 'get',
                contentType : "application/json",
                dataType : 'json',
                data: js_data
                    
            });
            // reload room list after deletion
            location.reload();
            if ($('#room').children('option').length <= 0) {
                $('#show_selection').fadeOut()

            }
        });
    });
</script>

{% endblock %}